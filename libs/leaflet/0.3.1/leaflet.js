/*
 Copyright (c) 2010-2011, CloudMade, Vladimir Agafonkin
 Leaflet is a modern open-source JavaScript library for interactive maps.
 http://leaflet.cloudmade.com
*/
(function(e){e.L={VERSION:"0.3",ROOT_URL:e.L_ROOT_URL||function(){var e=document.getElementsByTagName("script"),t=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/,n,r,i,s;for(n=0,r=e.length;n<r;n++){i=e[n].src,s=i.match(t);if(s)return s[1]==="include"?"../../dist/":i.split(t)[0]+"/"}return""}(),noConflict:function(){return e.L=this._originalL,this},_originalL:e.L}})(this),L.Util={extend:function(e){var t=Array.prototype.slice.call(arguments,1);for(var n=0,r=t.length,i;n<r;n++){i=t[n]||{};for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])}return e},bind:function(e,t){return function(){return e.apply(t,arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(n){return n[t]=n[t]||++e,n[t]}}(),requestAnimFrame:function(){function e(e){window.setTimeout(e,1e3/60)}var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||e;return function(n,r,i,s){n=r?L.Util.bind(n,r):n,i&&t===e?n():t(n,s)}}(),limitExecByInterval:function(e,t,n){function o(){r=!1,i&&(s.callee.apply(n,s),i=!1)}var r,i,s;return function(){s=arguments,r?i=!0:(r=!0,setTimeout(o,t),e.apply(n,s))}},falseFn:function(){return!1},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},setOptions:function(e,t){e.options=L.Util.extend({},e.options,t)},getParamString:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);return"?"+t.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,n){var r=t[n];if(!t.hasOwnProperty(n))throw Error("No value provided for variable "+e);return r})}},L.Class=function(){},L.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments)},n=function(){};n.prototype=this.prototype;var r=new n;r.constructor=t,t.prototype=r,t.superclass=this.prototype;for(var i in this)this.hasOwnProperty(i)&&i!=="prototype"&&i!=="superclass"&&(t[i]=this[i]);return e.statics&&(L.Util.extend(t,e.statics),delete e.statics),e.includes&&(L.Util.extend.apply(null,[r].concat(e.includes)),delete e.includes),e.options&&r.options&&(e.options=L.Util.extend({},r.options,e.options)),L.Util.extend(r,e),t.extend=L.Class.extend,t.include=function(e){L.Util.extend(this.prototype,e)},t},L.Mixin={},L.Mixin.Events={addEventListener:function(e,t,n){var r=this._leaflet_events=this._leaflet_events||{};return r[e]=r[e]||[],r[e].push({action:t,context:n||this}),this},hasEventListeners:function(e){var t="_leaflet_events";return t in this&&e in this[t]&&this[t][e].length>0},removeEventListener:function(e,t,n){if(!this.hasEventListeners(e))return this;for(var r=0,i=this._leaflet_events,s=i[e].length;r<s;r++)if(i[e][r].action===t&&(!n||i[e][r].context===n))return i[e].splice(r,1),this;return this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;var n=L.Util.extend({type:e,target:this},t),r=this._leaflet_events[e].slice();for(var i=0,s=r.length;i<s;i++)r[i].action.call(r[i].context||this,n);return this}},L.Mixin.Events.on=L.Mixin.Events.addEventListener,L.Mixin.Events.off=L.Mixin.Events.removeEventListener,L.Mixin.Events.fire=L.Mixin.Events.fireEvent,function(){var e=navigator.userAgent.toLowerCase(),t=!!window.ActiveXObject,n=e.indexOf("webkit")!==-1,r=typeof orientation!="undefined"?!0:!1,i=e.indexOf("android")!==-1,s=window.opera;L.Browser={ie:t,ie6:t&&!window.XMLHttpRequest,webkit:n,webkit3d:n&&"WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix,gecko:e.indexOf("gecko")!==-1,opera:s,android:i,mobileWebkit:r&&n,mobileOpera:r&&s,mobile:r,touch:function(){var e=!1,t="ontouchstart";if(t in document.documentElement)return!0;var n=document.createElement("div");return!n.setAttribute||!n.removeAttribute?!1:(n.setAttribute(t,"return;"),typeof n[t]=="function"&&(e=!0),n.removeAttribute(t),n=null,e)}()}}(),L.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},L.Point.prototype={add:function(e){return this.clone()._add(e)},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(e)},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e,t){return new L.Point(this.x/e,this.y/e,t)},multiplyBy:function(e){return new L.Point(this.x*e,this.y*e)},distanceTo:function(e){var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new L.Point(this.x,this.y)},toString:function(){return"Point("+L.Util.formatNum(this.x)+", "+L.Util.formatNum(this.y)+")"}},L.Bounds=L.Class.extend({initialize:function(e,t){if(!e)return;var n=e instanceof Array?e:[e,t];for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},extend:function(e){!this.min&&!this.max?(this.min=new L.Point(e.x,e.y),this.max=new L.Point(e.x,e.y)):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y))},getCenter:function(e){return new L.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},contains:function(e){var t,n;return e instanceof L.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){var t=this.min,n=this.max,r=e.min,i=e.max,s=i.x>=t.x&&r.x<=n.x,o=i.y>=t.y&&r.y<=n.y;return s&&o}}),L.Transformation=L.Class.extend({initialize:function(e,t,n,r){this._a=e,this._b=t,this._c=n,this._d=r},transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new L.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}}),L.DomUtil={get:function(e){return typeof e=="string"?document.getElementById(e):e},getStyle:function(e,t){var n=e.style[t];!n&&e.currentStyle&&(n=e.currentStyle[t]);if(!n||n==="auto"){var r=document.defaultView.getComputedStyle(e,null);n=r?r[t]:null}return n==="auto"?null:n},getViewportOffset:function(e){var t=0,n=0,r=e,i=document.body;do{t+=r.offsetTop||0,n+=r.offsetLeft||0;if(r.offsetParent===i&&L.DomUtil.getStyle(r,"position")==="absolute")break;r=r.offsetParent}while(r);r=e;do{if(r===i)break;t-=r.scrollTop||0,n-=r.scrollLeft||0,r=r.parentNode}while(r);return new L.Point(n,t)},create:function(e,t,n){var r=document.createElement(e);return r.className=t,n&&n.appendChild(r),r},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=L.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(e,t){return e.className.length>0&&RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){L.DomUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){e.className=e.className.replace(/(\S+)\s*/g,function(e,n){return n===t?"":e}).replace(/^\s+/,"")},setOpacity:function(e,t){L.Browser.ie?e.style.filter="alpha(opacity="+Math.round(t*100)+")":e.style.opacity=t},testProp:function(e){var t=document.documentElement.style;for(var n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1},getTranslateString:function(e){return L.DomUtil.TRANSLATE_OPEN+e.x+"px,"+e.y+"px"+L.DomUtil.TRANSLATE_CLOSE},getScaleString:function(e,t){var n=L.DomUtil.getTranslateString(t),r=" scale("+e+") ",i=L.DomUtil.getTranslateString(t.multiplyBy(-1));return n+r+i},setPosition:function(e,t){e._leaflet_pos=t,L.Browser.webkit3d?(e.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(t),L.Browser.android&&(e.style["-webkit-perspective"]="1000",e.style["-webkit-backface-visibility"]="hidden")):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},L.Util.extend(L.DomUtil,{TRANSITION:L.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:L.DomUtil.testProp(["transformProperty","WebkitTransform","OTransform","MozTransform","msTransform"]),TRANSLATE_OPEN:"translate"+(L.Browser.webkit3d?"3d(":"("),TRANSLATE_CLOSE:L.Browser.webkit3d?",0)":")"}),L.LatLng=function(e,t,n){var r=parseFloat(e),i=parseFloat(t);if(isNaN(r)||isNaN(i))throw Error("Invalid LatLng object: ("+e+", "+t+")");n!==!0&&(r=Math.max(Math.min(r,90),-90),i=(i+180)%360+(i<-180||i===180?180:-180)),this.lat=r,this.lng=i},L.Util.extend(L.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),L.LatLng.prototype={equals:function(e){if(e instanceof L.LatLng){var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=L.LatLng.MAX_MARGIN}return!1},toString:function(){return"LatLng("+L.Util.formatNum(this.lat)+", "+L.Util.formatNum(this.lng)+")"},distanceTo:function(e){var t=6378137,n=L.LatLng.DEG_TO_RAD,r=(e.lat-this.lat)*n,i=(e.lng-this.lng)*n,s=this.lat*n,o=e.lat*n,u=Math.sin(r/2),a=Math.sin(i/2),f=u*u+a*a*Math.cos(s)*Math.cos(o);return t*2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))}},L.LatLngBounds=L.Class.extend({initialize:function(e,t){if(!e)return;var n=e instanceof Array?e:[e,t];for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},extend:function(e){!this._southWest&&!this._northEast?(this._southWest=new L.LatLng(e.lat,e.lng,!0),this._northEast=new L.LatLng(e.lat,e.lng,!0)):(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng))},getCenter:function(){return new L.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new L.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new L.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(e){var t=this._southWest,n=this._northEast,r,i;return e instanceof L.LatLngBounds?(r=e.getSouthWest(),i=e.getNorthEast()):r=i=e,r.lat>=t.lat&&i.lat<=n.lat&&r.lng>=t.lng&&i.lng<=n.lng},intersects:function(e){var t=this._southWest,n=this._northEast,r=e.getSouthWest(),i=e.getNorthEast(),s=i.lat>=t.lat&&r.lat<=n.lat,o=i.lng>=t.lng&&r.lng<=n.lng;return s&&o},toBBoxString:function(){var e=this._southWest,t=this._northEast;return[e.lng,e.lat,t.lng,t.lat].join(",")}}),L.Projection={},L.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=L.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),i=e.lng*t,s=r*t;return s=Math.log(Math.tan(Math.PI/4+s/2)),new L.Point(i,s)},unproject:function(e,t){var n=L.LatLng.RAD_TO_DEG,r=e.x*n,i=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*n;return new L.LatLng(i,r,t)}},L.Projection.LonLat={project:function(e){return new L.Point(e.lng,e.lat)},unproject:function(e,t){return new L.LatLng(e.y,e.x,t)}},L.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e);return this.transformation._transform(n,t)},pointToLatLng:function(e,t,n){var r=this.transformation.untransform(e,t);return this.projection.unproject(r,n)},project:function(e){return this.projection.project(e)}},L.CRS.EPSG3857=L.Util.extend({},L.CRS,{code:"EPSG:3857",projection:L.Projection.SphericalMercator,transformation:new L.Transformation(.5/Math.PI,.5,-0.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),n=6378137;return t.multiplyBy(n)}}),L.CRS.EPSG900913=L.Util.extend({},L.CRS.EPSG3857,{code:"EPSG:900913"}),L.CRS.EPSG4326=L.Util.extend({},L.CRS,{code:"EPSG:4326",projection:L.Projection.LonLat,transformation:new L.Transformation(1/360,.5,-1/360,.5)}),L.Map=L.Class.extend({includes:L.Mixin.Events,options:{crs:L.CRS.EPSG3857||L.CRS.EPSG4326,scale:function(e){return 256*Math.pow(2,e)},center:null,zoom:null,layers:[],dragging:!0,touchZoom:L.Browser.touch&&!L.Browser.android,scrollWheelZoom:!L.Browser.touch,doubleClickZoom:!0,boxZoom:!0,zoomControl:!0,attributionControl:!0,fadeAnimation:L.DomUtil.TRANSITION&&!L.Browser.android,zoomAnimation:L.DomUtil.TRANSITION&&!L.Browser.android&&!L.Browser.mobileOpera,trackResize:!0,closePopupOnClick:!0,worldCopyJump:!0},initialize:function(e,t){L.Util.setOptions(this,t),this._container=L.DomUtil.get(e);if(this._container._leaflet)throw Error("Map container is already initialized.");this._container._leaflet=!0,this._initLayout(),L.DomEvent&&(this._initEvents(),L.Handler&&this._initInteraction(),L.Control&&this._initControls()),this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds);var n=this.options.center,r=this.options.zoom;n!==null&&r!==null&&this.setView(n,r,!0);var i=this.options.layers;i=i instanceof Array?i:[i],this._tileLayersNum=0,this._initLayers(i)},setView:function(e,t){return this._resetView(e,this._limitZoom(t)),this},setZoom:function(e){return this.setView(this.getCenter(),e)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(e){var t=this.getBoundsZoom(e);return this.setView(e.getCenter(),t)},fitWorld:function(){var e=new L.LatLng(-60,-170),t=new L.LatLng(85,179);return this.fitBounds(new L.LatLngBounds(e,t))},panTo:function(e){return this.setView(e,this._zoom)},panBy:function(e){return this.fire("movestart"),this._rawPanBy(e),this.fire("move"),this.fire("moveend"),this},setMaxBounds:function(e){this.options.maxBounds=e;if(!e)return this._boundsMinZoom=null,this;var t=this.getBoundsZoom(e,!0);return this._boundsMinZoom=t,this._loaded&&(this._zoom<t?this.setView(e.getCenter(),t):this.panInsideBounds(e)),this},panInsideBounds:function(e){var t=this.getBounds(),n=this.project(t.getSouthWest()),r=this.project(t.getNorthEast()),i=this.project(e.getSouthWest()),s=this.project(e.getNorthEast()),o=0,u=0;return r.y<s.y&&(u=s.y-r.y),r.x>s.x&&(o=s.x-r.x),n.y>i.y&&(u=i.y-n.y),n.x<i.x&&(o=i.x-n.x),this.panBy(new L.Point(o,u,!0))},addLayer:function(e,t){var n=L.Util.stamp(e);if(this._layers[n])return this;this._layers[n]=e,e.options&&!isNaN(e.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,e.options.maxZoom)),e.options&&!isNaN(e.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||Infinity,e.options.minZoom)),this.options.zoomAnimation&&L.TileLayer&&e instanceof L.TileLayer&&(this._tileLayersNum++,e.on("load",this._onTileLayerLoad,this)),this.attributionControl&&e.getAttribution&&this.attributionControl.addAttribution(e.getAttribution());var r=function(){e.onAdd(this,t),this.fire("layeradd",{layer:e})};return this._loaded?r.call(this):this.on("load",r,this),this},removeLayer:function(e){var t=L.Util.stamp(e);return this._layers[t]&&(e.onRemove(this),delete this._layers[t],this.options.zoomAnimation&&L.TileLayer&&e instanceof L.TileLayer&&(this._tileLayersNum--,e.off("load",this._onTileLayerLoad,this)),this.attributionControl&&e.getAttribution&&this.attributionControl.removeAttribution(e.getAttribution()),this.fire("layerremove",{layer:e})),this},hasLayer:function(e){var t=L.Util.stamp(e);return this._layers.hasOwnProperty(t)},invalidateSize:function(){var e=this.getSize();return this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),this._loaded?(this._rawPanBy(e.subtract(this.getSize()).divideBy(2,!0)),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(L.Util.bind(function(){this.fire("moveend")},this),200),this):this},getCenter:function(e){var t=this.getSize().divideBy(2),n=this._getTopLeftPoint().add(t);return this.unproject(n,this._zoom,e)},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(new L.Point(e.min.x,e.max.y),this._zoom,!0),n=this.unproject(new L.Point(e.max.x,e.min.y),this._zoom,!0);return new L.LatLngBounds(t,n)},getMinZoom:function(){var e=this.options.minZoom||0,t=this._layersMinZoom||0,n=this._boundsMinZoom||0;return Math.max(e,t,n)},getMaxZoom:function(){var e=isNaN(this.options.maxZoom)?Infinity:this.options.maxZoom,t=this._layersMaxZoom||Infinity;return Math.min(e,t)},getBoundsZoom:function(e,t){var n=this.getSize(),r=this.options.minZoom||0,i=this.getMaxZoom(),s=e.getNorthEast(),o=e.getSouthWest(),u,a,f,l=!0;t&&r--;do r++,a=this.project(s,r),f=this.project(o,r),u=new L.Point(a.x-f.x,f.y-a.y),t?l=u.x<n.x||u.y<n.y:l=u.x<=n.x&&u.y<=n.y;while(l&&r<=i);return l&&t?null:t?r:r-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new L.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size},getPixelBounds:function(){var e=this._getTopLeftPoint(),t=this.getSize();return new L.Bounds(e,e.add(t))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},mouseEventToContainerPoint:function(e){return L.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},containerPointToLayerPoint:function(e){return e.subtract(L.DomUtil.getPosition(this._mapPane))},layerPointToContainerPoint:function(e){return e.add(L.DomUtil.getPosition(this._mapPane))},layerPointToLatLng:function(e){return this.unproject(e.add(this._initialTopLeftPoint))},latLngToLayerPoint:function(e){return this.project(e)._round()._subtract(this._initialTopLeftPoint)},project:function(e,t){return t=typeof t=="undefined"?this._zoom:t,this.options.crs.latLngToPoint(e,this.options.scale(t))},unproject:function(e,t,n){return t=typeof t=="undefined"?this._zoom:t,this.options.crs.pointToLatLng(e,this.options.scale(t),n)},_initLayout:function(){var e=this._container;e.innerHTML="",e.className+=" leaflet-container",this.options.fadeAnimation&&(e.className+=" leaflet-fade-anim");var t=L.DomUtil.getStyle(e,"position");t!=="absolute"&&t!=="relative"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane")},_createPane:function(e,t){return L.DomUtil.create("div",e,t||this._objectsPane)},_resetView:function(e,t,n,r){var i=this._zoom!==t;r||(this.fire("movestart"),i&&this.fire("zoomstart")),this._zoom=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(e);if(!n)L.DomUtil.setPosition(this._mapPane,new L.Point(0,0));else{var s=L.DomUtil.getPosition(this._mapPane);this._initialTopLeftPoint._add(s)}this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!n}),this.fire("move"),(i||r)&&this.fire("zoomend"),this.fire("moveend"),this._loaded||(this._loaded=!0,this.fire("load"))},_initLayers:function(e){this._layers={};var t,n;for(t=0,n=e.length;t<n;t++)this.addLayer(e[t])},_initControls:function(){this.options.zoomControl&&this.addControl(new L.Control.Zoom),this.options.attributionControl&&(this.attributionControl=new L.Control.Attribution,this.addControl(this.attributionControl))},_rawPanBy:function(e){var t=L.DomUtil.getPosition(this._mapPane);L.DomUtil.setPosition(this._mapPane,t.subtract(e))},_initEvents:function(){L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);var e=["dblclick","mousedown","mouseenter","mouseleave","mousemove","contextmenu"],t,n;for(t=0,n=e.length;t<n;t++)L.DomEvent.addListener(this._container,e[t],this._fireMouseEvent,this);this.options.trackResize&&L.DomEvent.addListener(window,"resize",this._onResize,this)},_onResize:function(){L.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(e){if(!this._loaded||this.dragging&&this.dragging.moved())return;this.fire("pre"+e.type),this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(!this._loaded)return;var t=e.type;t=t==="mouseenter"?"mouseover":t==="mouseleave"?"mouseout":t;if(!this.hasEventListeners(t))return;t==="contextmenu"&&L.DomEvent.preventDefault(e),this.fire(t,{latlng:this.mouseEventToLatLng(e),layerPoint:this.mouseEventToLayerPoint(e)})},_initInteraction:function(){var e={dragging:L.Map.Drag,touchZoom:L.Map.TouchZoom,doubleClickZoom:L.Map.DoubleClickZoom,scrollWheelZoom:L.Map.ScrollWheelZoom,boxZoom:L.Map.BoxZoom},t;for(t in e)e.hasOwnProperty(t)&&e[t]&&(this[t]=new e[t](this),this.options[t]&&this[t].enable())},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(L.Util.bind(this._clearTileBg,this),500))},_getTopLeftPoint:function(){if(!this._loaded)throw Error("Set map center and zoom first.");var e=L.DomUtil.getPosition(this._mapPane);return this._initialTopLeftPoint.subtract(e)},_getNewTopLeftPoint:function(e){var t=this.getSize().divideBy(2);return this.project(e).subtract(t).round()},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom();return Math.max(t,Math.min(n,e))}}),L.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(e){var t=L.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),i=this.R_MAJOR,s=this.R_MINOR,o=e.lng*t*i,u=r*t,a=s/i,f=Math.sqrt(1-a*a),l=f*Math.sin(u);l=Math.pow((1-l)/(1+l),f*.5);var c=Math.tan(.5*(Math.PI*.5-u))/l;return u=-s*Math.log(c),new L.Point(o,u)},unproject:function(e,t){var n=L.LatLng.RAD_TO_DEG,r=this.R_MAJOR,i=this.R_MINOR,s=e.x*n/r,o=i/r,u=Math.sqrt(1-o*o),a=Math.exp(-e.y/i),f=Math.PI/2-2*Math.atan(a),l=15,c=1e-7,h=l,p=.1,d;while(Math.abs(p)>c&&--h>0)d=u*Math.sin(f),p=Math.PI/2-2*Math.atan(a*Math.pow((1-d)/(1+d),.5*u))-f,f+=p;return new L.LatLng(f*n,s,t)}},L.CRS.EPSG3395=L.Util.extend({},L.CRS,{code:"EPSG:3395",projection:L.Projection.Mercator,transformation:function(){var e=L.Projection.Mercator,t=e.R_MAJOR,n=e.R_MINOR;return new L.Transformation(.5/(Math.PI*t),.5,-0.5/(Math.PI*n),.5)}()}),L.TileLayer=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,scheme:"xyz",continuousWorld:!1,noWrap:!1,zoomOffset:0,zoomReverse:!1,unloadInvisibleTiles:L.Browser.mobile,updateWhenIdle:L.Browser.mobile,reuseTiles:!1},initialize:function(e,t,n){L.Util.setOptions(this,t),this._url=e,this._urlParams=n,typeof this.options.subdomains=="string"&&(this.options.subdomains=this.options.subdomains.split(""))},onAdd:function(e,t){this._map=e,this._insertAtTheBottom=t,this._initContainer(),this._createTileProto(),e.on("viewreset",this._resetCallback,this),this.options.updateWhenIdle?e.on("moveend",this._update,this):(this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},onRemove:function(e){this._map.getPanes().tilePane.removeChild(this._container),this._container=null,this._map.off("viewreset",this._resetCallback,this),this.options.updateWhenIdle?this._map.off("moveend",this._update,this):this._map.off("move",this._limitedUpdate,this)},getAttribution:function(){return this.options.attribution},setOpacity:function(e){this.options.opacity=e,this._setOpacity(e);if(L.Browser.webkit)for(var t in this._tiles)this._tiles.hasOwnProperty(t)&&(this._tiles[t].style.webkitTransform+=" translate(0,0)")},_setOpacity:function(e){e<1&&L.DomUtil.setOpacity(this._container,e)},_initContainer:function(){var e=this._map.getPanes().tilePane,t=e.firstChild;if(!this._container||e.empty)this._container=L.DomUtil.create("div","leaflet-layer"),this._insertAtTheBottom&&t?e.insertBefore(this._container,t):e.appendChild(this._container),this._setOpacity(this.options.opacity)},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){var t;for(t in this._tiles)this._tiles.hasOwnProperty(t)&&this.fire("tileunload",{tile:this._tiles[t]});this._tiles={},this.options.reuseTiles&&(this._unusedTiles=[]),e&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(){var e=this._map.getPixelBounds(),t=this._map.getZoom(),n=this.options.tileSize;if(t>this.options.maxZoom||t<this.options.minZoom)return;var r=new L.Point(Math.floor(e.min.x/n),Math.floor(e.min.y/n)),i=new L.Point(Math.floor(e.max.x/n),Math.floor(e.max.y/n)),s=new L.Bounds(r,i);this._addTilesFromCenterOut(s),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(s)},_addTilesFromCenterOut:function(e){var t=[],n=e.getCenter();for(var r=e.min.y;r<=e.max.y;r++)for(var i=e.min.x;i<=e.max.x;i++){if(i+":"+r in this._tiles)continue;t.push(new L.Point(i,r))}t.sort(function(e,t){return e.distanceTo(n)-t.distanceTo(n)});var s=document.createDocumentFragment();this._tilesToLoad=t.length;for(var o=0,u=this._tilesToLoad;o<u;o++)this._addTile(t[o],s);this._container.appendChild(s)},_removeOtherTiles:function(e){var t,n,r,i,s;for(i in this._tiles)if(this._tiles.hasOwnProperty(i)){t=i.split(":"),n=parseInt(t[0],10),r=parseInt(t[1],10);if(n<e.min.x||n>e.max.x||r<e.min.y||r>e.max.y)s=this._tiles[i],this.fire("tileunload",{tile:s,url:s.src}),s.parentNode===this._container&&this._container.removeChild(s),this.options.reuseTiles&&this._unusedTiles.push(this._tiles[i]),s.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",delete this._tiles[i]}},_addTile:function(e,t){var n=this._getTilePos(e),r=this._map.getZoom(),i=e.x+":"+e.y,s=Math.pow(2,this._getOffsetZoom(r));if(!this.options.continuousWorld){if(!this.options.noWrap)e.x=(e.x%s+s)%s;else if(e.x<0||e.x>=s){this._tilesToLoad--;return}if(e.y<0||e.y>=s){this._tilesToLoad--;return}}var o=this._getTile();L.DomUtil.setPosition(o,n),this._tiles[i]=o,this.options.scheme==="tms"&&(e.y=s-e.y-1),this._loadTile(o,e,r),t.appendChild(o)},_getOffsetZoom:function(e){return e=this.options.zoomReverse?this.options.maxZoom-e:e,e+this.options.zoomOffset},_getTilePos:function(e){var t=this._map.getPixelOrigin(),n=this.options.tileSize;return e.multiplyBy(n).subtract(t)},getTileUrl:function(e,t){var n=this.options.subdomains,r=this.options.subdomains[(e.x+e.y)%n.length];return L.Util.template(this._url,L.Util.extend({s:r,z:this._getOffsetZoom(t),x:e.x,y:e.y},this._urlParams))},_createTileProto:function(){this._tileImg=L.DomUtil.create("img","leaflet-tile"),this._tileImg.galleryimg="no";var e=this.options.tileSize;this._tileImg.style.width=e+"px",this._tileImg.style.height=e+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(e){},_createTile:function(){var e=this._tileImg.cloneNode(!1);return e.onselectstart=e.onmousemove=L.Util.falseFn,e},_loadTile:function(e,t,n){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,e.src=this.getTileUrl(t,n)},_tileOnLoad:function(e){var t=this._layer;this.className+=" leaflet-tile-loaded",t.fire("tileload",{tile:this,url:this.src}),t._tilesToLoad--,t._tilesToLoad||t.fire("load")},_tileOnError:function(e){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var n=t.options.errorTileUrl;n&&(this.src=n)}}),L.TileLayer.WMS=L.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e,this.wmsParams=L.Util.extend({},this.defaultWmsParams),this.wmsParams.width=this.wmsParams.height=this.options.tileSize;for(var n in t)this.options.hasOwnProperty(n)||(this.wmsParams[n]=t[n]);L.Util.setOptions(this,t)},onAdd:function(e){var t=parseFloat(this.wmsParams.version)<1.3?"srs":"crs";this.wmsParams[t]=e.options.crs.code,L.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var n=this.options.tileSize,r=e.multiplyBy(n),i=r.add(new L.Point(n,n)),s=this._map.unproject(r,this._zoom,!0),o=this._map.unproject(i,this._zoom,!0),u=this._map.options.crs.project(s),a=this._map.options.crs.project(o),f=[u.x,a.y,a.x,u.y].join(",");return this._url+L.Util.getParamString(this.wmsParams)+"&bbox="+f}}),L.TileLayer.Canvas=L.TileLayer.extend({options:{async:!1},initialize:function(e){L.Util.setOptions(this,e)},redraw:function(){for(var e in this._tiles){var t=this._tiles[e];this._redrawTile(t)}},_redrawTile:function(e){this.drawTile(e,e._tilePoint,e._zoom)},_createTileProto:function(){this._canvasProto=L.DomUtil.create("canvas","leaflet-tile");var e=this.options.tileSize;this._canvasProto.width=e,this._canvasProto.height=e},_createTile:function(){var e=this._canvasProto.cloneNode(!1);return e.onselectstart=e.onmousemove=L.Util.falseFn,e},_loadTile:function(e,t,n){e._layer=this,e._tilePoint=t,e._zoom=n,this.drawTile(e,t,n),this.options.async||this.tileDrawn(e)},drawTile:function(e,t,n){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),L.ImageOverlay=L.Class.extend({includes:L.Mixin.Events,initialize:function(e,t){this._url=e,this._bounds=t},onAdd:function(e){this._map=e,this._image||this._initImage(),e.getPanes().overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this)},_initImage:function(){this._image=L.DomUtil.create("img","leaflet-image-layer"),this._image.style.visibility="hidden",L.Util.extend(this._image,{galleryimg:"no",onselectstart:L.Util.falseFn,onmousemove:L.Util.falseFn,onload:L.Util.bind(this._onImageLoad,this),src:this._url})},_reset:function(){var e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),t=this._map.latLngToLayerPoint(this._bounds.getSouthEast()),n=t.subtract(e);L.DomUtil.setPosition(this._image,e),this._image.style.width=n.x+"px",this._image.style.height=n.y+"px"},_onImageLoad:function(){this._image.style.visibility="",this.fire("load")}}),L.Icon=L.Class.extend({iconUrl:L.ROOT_URL+"images/marker.png",shadowUrl:L.ROOT_URL+"images/marker-shadow.png",iconSize:new L.Point(25,41),shadowSize:new L.Point(41,41),iconAnchor:new L.Point(13,41),popupAnchor:new L.Point(0,-33),initialize:function(e){e&&(this.iconUrl=e)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(e){var t=this[e+"Size"],n=this[e+"Url"];if(!n&&e==="shadow")return null;var r;return n?r=this._createImg(n):r=this._createDiv(),r.className="leaflet-marker-"+e,r.style.marginLeft=-this.iconAnchor.x+"px",r.style.marginTop=-this.iconAnchor.y+"px",t&&(r.style.width=t.x+"px",r.style.height=t.y+"px"),r},_createImg:function(e){var t;return L.Browser.ie6?(t=document.createElement("div"),t.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e+'")'):(t=document.createElement("img"),t.src=e),t},_createDiv:function(){return document.createElement("div")}}),L.Marker=L.Class.extend({includes:L.Mixin.Events,options:{icon:new L.Icon,title:"",clickable:!0,draggable:!1,zIndexOffset:0},initialize:function(e,t){L.Util.setOptions(this,t),this._latlng=e},onAdd:function(e){this._map=e,this._initIcon(),e.on("viewreset",this._reset,this),this._reset()},onRemove:function(e){this._removeIcon(),this.closePopup&&this.closePopup(),this._map=null,e.off("viewreset",this._reset,this)},getLatLng:function(){return this._latlng},setLatLng:function(e){this._latlng=e,this._icon&&(this._reset(),this._popup&&this._popup.setLatLng(this._latlng))},setZIndexOffset:function(e){this.options.zIndexOffset=e,this._icon&&this._reset()},setIcon:function(e){this._map&&this._removeIcon(),this.options.icon=e,this._map&&(this._initIcon(),this._reset())},_initIcon:function(){this._icon||(this._icon=this.options.icon.createIcon(),this.options.title&&(this._icon.title=this.options.title),this._initInteraction()),this._shadow||(this._shadow=this.options.icon.createShadow()),this._map._panes.markerPane.appendChild(this._icon),this._shadow&&this._map._panes.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this._map._panes.markerPane.removeChild(this._icon),this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_reset:function(){var e=this._map.latLngToLayerPoint(this._latlng).round();L.DomUtil.setPosition(this._icon,e),this._shadow&&L.DomUtil.setPosition(this._shadow,e),this._icon.style.zIndex=e.y+this.options.zIndexOffset},_initInteraction:function(){if(this.options.clickable){this._icon.className+=" leaflet-clickable",L.DomEvent.addListener(this._icon,"click",this._onMouseClick,this);var e=["dblclick","mousedown","mouseover","mouseout"];for(var t=0;t<e.length;t++)L.DomEvent.addListener(this._icon,e[t],this._fireMouseEvent,this)}L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())},_onMouseClick:function(e){L.DomEvent.stopPropagation(e);if(this.dragging&&this.dragging.moved())return;this.fire(e.type)},_fireMouseEvent:function(e){this.fire(e.type),L.DomEvent.stopPropagation(e)}}),L.Popup=L.Class.extend({includes:L.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:new L.Point(0,2),autoPanPadding:new L.Point(5,5),className:""},initialize:function(e,t){L.Util.setOptions(this,e),this._source=t},onAdd:function(e){this._map=e,this._container||this._initLayout(),this._updateContent(),this._container.style.opacity="0",this._map._panes.popupPane.appendChild(this._container),this._map.on("viewreset",this._updatePosition,this),this._map.options.closePopupOnClick&&this._map.on("preclick",this._close,this),this._update(),this._container.style.opacity="1",this._opened=!0},onRemove:function(e){e._panes.popupPane.removeChild(this._container),L.Util.falseFn(this._container.offsetWidth),e.off("viewreset",this._updatePosition,this),e.off("click",this._close,this),this._container.style.opacity="0",this._opened=!1},setLatLng:function(e){return this._latlng=e,this._opened&&this._update(),this},setContent:function(e){return this._content=e,this._opened&&this._update(),this},_close:function(){this._opened&&this._map.closePopup()},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-popup "+this.options.className),this.options.closeButton&&(this._closeButton=L.DomUtil.create("a","leaflet-popup-close-button",this._container),this._closeButton.href="#close",L.DomEvent.addListener(this._closeButton,"click",this._onCloseButtonClick,this)),this._wrapper=L.DomUtil.create("div","leaflet-popup-content-wrapper",this._container),L.DomEvent.disableClickPropagation(this._wrapper),this._contentNode=L.DomUtil.create("div","leaflet-popup-content",this._wrapper),this._tipContainer=L.DomUtil.create("div","leaflet-popup-tip-container",this._container),this._tip=L.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_update:function(){this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_updateContent:function(){if(!this._content)return;typeof this._content=="string"?this._contentNode.innerHTML=this._content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this._content))},_updateLayout:function(){this._container.style.width="",this._container.style.whiteSpace="nowrap";var e=this._container.offsetWidth;this._container.style.width=(e>this.options.maxWidth?this.options.maxWidth:e<this.options.minWidth?this.options.minWidth:e)+"px",this._container.style.whiteSpace="",this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._containerBottom=-e.y-this.options.offset.y,this._containerLeft=e.x-Math.round(this._containerWidth/2)+this.options.offset.x,this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_adjustPan:function(){if(!this.options.autoPan)return;var e=this._container.offsetHeight,t=new L.Point(this._containerLeft,-e-this._containerBottom),n=this._map.layerPointToContainerPoint(t),r=new L.Point(0,0),i=this.options.autoPanPadding,s=this._map.getSize();n.x<0&&(r.x=n.x-i.x),n.x+this._containerWidth>s.x&&(r.x=n.x+this._containerWidth-s.x+i.x),n.y<0&&(r.y=n.y-i.y),n.y+e>s.y&&(r.y=n.y+e-s.y+i.y),(r.x||r.y)&&this._map.panBy(r)},_onCloseButtonClick:function(e){this._close(),L.DomEvent.stop(e)}}),L.Marker.include({openPopup:function(){return this._popup.setLatLng(this._latlng),this._map&&this._map.openPopup(this._popup),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(e,t){return t=L.Util.extend({offset:this.options.icon.popupAnchor},t),this._popup||this.on("click",this.openPopup,this),this._popup=new L.Popup(t,this),this._popup.setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),L.Map.include({openPopup:function(e){return this.closePopup(),this._popup=e,this.addLayer(e),this.fire("popupopen",{popup:this._popup}),this},closePopup:function(){return this._popup&&(this.removeLayer(this._popup),this.fire("popupclose",{popup:this._popup}),this._popup=null),this}}),L.LayerGroup=L.Class.extend({initialize:function(e){this._layers={};if(e)for(var t=0,n=e.length;t<n;t++)this.addLayer(e[t])},addLayer:function(e){var t=L.Util.stamp(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=L.Util.stamp(e);return delete this._layers[t],this._map&&this._map.removeLayer(e),this},clearLayers:function(){return this._iterateLayers(this.removeLayer,this),this},invoke:function(e){var t=Array.prototype.slice.call(arguments,1),n,r;for(n in this._layers)this._layers.hasOwnProperty(n)&&(r=this._layers[n],r[e]&&r[e].apply(r,t));return this},onAdd:function(e){this._map=e,this._iterateLayers(e.addLayer,e)},onRemove:function(e){this._iterateLayers(e.removeLayer,e),delete this._map},_iterateLayers:function(e,t){for(var n in this._layers)this._layers.hasOwnProperty(n)&&e.call(t,this._layers[n])}}),L.FeatureGroup=L.LayerGroup.extend({includes:L.Mixin.Events,addLayer:function(e){this._initEvents(e),L.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent)},bindPopup:function(e){return this._popupContent=e,this.invoke("bindPopup",e)},setStyle:function(e){return this.invoke("setStyle",e)},_events:["click","dblclick","mouseover","mouseout"],_initEvents:function(e){for(var t=0,n=this._events.length;t<n;t++)e.on(this._events[t],this._propagateEvent,this)},_propagateEvent:function(e){e.layer=e.target,e.target=this,this.fire(e.type,e)}}),L.Path=L.Class.extend({includes:[L.Mixin.Events],statics:{CLIP_PADDING:.5},options:{stroke:!0,color:"#0033ff",weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0,updateOnMoveEnd:!0},initialize:function(e){L.Util.setOptions(this,e)},onAdd:function(e){this._map=e,this._initElements(),this._initEvents(),this.projectLatlngs(),this._updatePath(),e.on("viewreset",this.projectLatlngs,this),this._updateTrigger=this.options.updateOnMoveEnd?"moveend":"viewreset",e.on(this._updateTrigger,this._updatePath,this)},onRemove:function(e){this._map=null,e._pathRoot.removeChild(this._container),e.off("viewreset",this.projectLatlngs,this),e.off(this._updateTrigger,this._updatePath,this)},projectLatlngs:function(){},setStyle:function(e){return L.Util.setOptions(this,e),this._container&&this._updateStyle(),this},_redraw:function(){this._map&&(this.projectLatlngs(),this._updatePath())}}),L.Map.include({_updatePathViewport:function(){var e=L.Path.CLIP_PADDING,t=this.getSize(),n=L.DomUtil.getPosition(this._mapPane),r=n.multiplyBy(-1).subtract(t.multiplyBy(e)),i=r.add(t.multiplyBy(1+e*2));this._pathViewport=new L.Bounds(r,i)}}),L.Path.SVG_NS="http://www.w3.org/2000/svg",L.Browser.svg=!!document.createElementNS&&!!document.createElementNS(L.Path.SVG_NS,"svg").createSVGRect,L.Path=L.Path.extend({statics:{SVG:L.Browser.svg,_createElement:function(e){return document.createElementNS(L.Path.SVG_NS,e)}},getPathString:function(){},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=L.Path._createElement("g"),this._path=L.Path._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill?this._path.setAttribute("fill-rule","evenodd"):this._path.setAttribute("fill","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight)),this.options.fill&&(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity))},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){L.Browser.vml||this._path.setAttribute("class","leaflet-clickable"),L.DomEvent.addListener(this._container,"click",this._onMouseClick,this);var e=["dblclick","mousedown","mouseover","mouseout","mousemove"];for(var t=0;t<e.length;t++)L.DomEvent.addListener(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){if(this._map.dragging&&this._map.dragging.moved())return;this._fireMouseEvent(e)},_fireMouseEvent:function(e){if(!this.hasEventListeners(e.type))return;this.fire(e.type,{latlng:this._map.mouseEventToLatLng(e),layerPoint:this._map.mouseEventToLayerPoint(e)}),L.DomEvent.stopPropagation(e)}}),L.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=L.Path._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_updateSvgViewport:function(){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max,r=n.x-t.x,i=n.y-t.y,s=this._pathRoot,o=this._panes.overlayPane;L.Browser.webkit&&o.removeChild(s),L.DomUtil.setPosition(s,t),s.setAttribute("width",r),s.setAttribute("height",i),s.setAttribute("viewBox",[t.x,t.y,r,i].join(" ")),L.Browser.webkit&&o.appendChild(s)}}),L.Path.include({bindPopup:function(e,t){if(!this._popup||this._popup.options!==t)this._popup=new L.Popup(t,this);return this._popup.setContent(e),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),L.Browser.vml=function(){var e=document.createElement("div"),t;return e.innerHTML='<v:shape adj="1"/>',t=e.firstChild,t.style.behavior="url(#default#VML)",t&&typeof t.adj=="object"}(),L.Path=L.Browser.svg||!L.Browser.vml?L.Path:L.Path.extend({statics:{VML:!0,CLIP_PADDING:.02,_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()},_initPath:function(){this._container=L.Path._createElement("shape"),this._container.className+=" leaflet-vml-shape"+(this.options.clickable?" leaflet-clickable":""),this._container.coordsize="1 1",this._path=L.Path._createElement("path"),this._container.appendChild(this._path),this._map._pathRoot.appendChild(this._container)},_initStyle:function(){this.options.stroke?(this._stroke=L.Path._createElement("stroke"),this._stroke.endcap="round",this._container.appendChild(this._stroke)):this._container.stroked=!1,this.options.fill?(this._container.filled=!0,this._fill=L.Path._createElement("fill"),this._container.appendChild(this._fill)):this._container.filled=!1,this._updateStyle()},_updateStyle:function(){this.options.stroke&&(this._stroke.weight=this.options.weight+"px",this._stroke.color=this.options.color,this._stroke.opacity=this.options.opacity),this.options.fill&&(this._fill.color=this.options.fillColor||this.options.color,this._fill.opacity=this.options.fillOpacity)},_updatePath:function(){this._container.style.display="none",this._path.v=this.getPathString()+" ",this._container.style.display=""}}),L.Map.include(L.Browser.svg||!L.Browser.vml?{}:{_initPathRoot:function(){this._pathRoot||(this._pathRoot=document.createElement("div"),this._pathRoot.className="leaflet-vml-container",this._panes.overlayPane.appendChild(this._pathRoot),this.on("moveend",this._updatePathViewport),this._updatePathViewport())}}),L.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),L.Path=L.Path.SVG&&!window.L_PREFER_CANVAS||!L.Browser.canvas?L.Path:L.Path.extend({statics:{CANVAS:!0,SVG:!1},options:{updateOnMoveEnd:!0},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){this.options.stroke&&(this._ctx.lineWidth=this.options.weight,this._ctx.strokeStyle=this.options.color),this.options.fill&&(this._ctx.fillStyle=this.options.fillColor||this.options.color)},_drawPath:function(){var e,t,n,r,i,s;this._ctx.beginPath();for(e=0,n=this._parts.length;e<n;e++){for(t=0,r=this._parts[e].length;t<r;t++)i=this._parts[e][t],s=(t===0?"move":"line")+"To",this._ctx[s](i.x,i.y);this instanceof L.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(this._checkIfEmpty())return;this._drawPath(),this._ctx.save(),this._updateStyle();var e=this.options.opacity,t=this.options.fillOpacity;this.options.fill&&(t<1&&(this._ctx.globalAlpha=t),this._ctx.fill()),this.options.stroke&&(e<1&&(this._ctx.globalAlpha=e),this._ctx.stroke()),this._ctx.restore()},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)},onRemove:function(e){e.off("viewreset",this._projectLatlngs,this),e.off(this._updateTrigger,this._updatePath,this),e.fire(this._updateTrigger)}}),L.Map.include(L.Path.SVG&&!window.L_PREFER_CANVAS||!L.Browser.canvas?{}:{_initPathRoot:function(){var e=this._pathRoot,t;e||(e=this._pathRoot=document.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max.subtract(t),r=this._pathRoot;L.DomUtil.setPosition(r,t),r.width=n.x,r.height=n.y,r.getContext("2d").translate(-t.x,-t.y)}}),L.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=this._reducePoints(e,n),e=this._simplifyDP(e,n),e},pointToSegmentDistance:function(e,t,n){return Math.sqrt(this._sqClosestPointOnSegment(e,t,n,!0))},closestPointOnSegment:function(e,t,n){return this._sqClosestPointOnSegment(e,t,n)},_simplifyDP:function(e,t){var n=e.length,r=typeof Uint8Array!="undefined"?Uint8Array:Array,i=new r(n);i[0]=i[n-1]=1,this._simplifyDPStep(e,i,t,0,n-1);var s,o=[];for(s=0;s<n;s++)i[s]&&o.push(e[s]);return o},_simplifyDPStep:function(e,t,n,r,i){var s=0,o,u,a;for(u=r+1;u<=i-1;u++)a=this._sqClosestPointOnSegment(e[u],e[r],e[i],!0),a>s&&(o=u,s=a);s>n&&(t[o]=1,this._simplifyDPStep(e,t,n,r,o),this._simplifyDPStep(e,t,n,o,i))},_reducePoints:function(e,t){var n=[e[0]];for(var r=1,i=0,s=e.length;r<s;r++)this._sqDist(e[r],e[i])>t&&(n.push(e[r]),i=r);return i<s-1&&n.push(e[s-1]),n},clipSegment:function(e,t,n,r){var i=n.min,s=n.max,o=r?this._lastCode:this._getBitCode(e,n),u=this._getBitCode(t,n);this._lastCode=u;for(;;){if(!(o|u))return[e,t];if(o&u)return!1;var a=o||u,f=this._getEdgeIntersection(e,t,a,n),l=this._getBitCode(f,n);a===o?(e=f,o=l):(t=f,u=l)}},_getEdgeIntersection:function(e,t,n,r){var i=t.x-e.x,s=t.y-e.y,o=r.min,u=r.max;if(n&8)return new L.Point(e.x+i*(u.y-e.y)/s,u.y);if(n&4)return new L.Point(e.x+i*(o.y-e.y)/s,o.y);if(n&2)return new L.Point(u.x,e.y+s*(u.x-e.x)/i);if(n&1)return new L.Point(o.x,e.y+s*(o.x-e.x)/i)},_getBitCode:function(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n},_sqDist:function(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},_sqClosestPointOnSegment:function(e,t,n,r){var i=t.x,s=t.y,o=n.x-i,u=n.y-s,a=o*o+u*u,f;return a>0&&(f=((e.x-i)*o+(e.y-s)*u)/a,f>1?(i=n.x,s=n.y):f>0&&(i+=o*f,s+=u*f)),o=e.x-i,u=e.y-s,r?o*o+u*u:new L.Point(i,s)}},L.Polyline=L.Path.extend({initialize:function(e,t){L.Path.prototype.initialize.call(this,t),this._latlngs=e},options:{smoothFactor:1,noClip:!1,updateOnMoveEnd:!0},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;e<t;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,n="";e<t;e++)n+=this._getPathPartStr(this._parts[e]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=e,this._redraw(),this},addLatLng:function(e){return this._latlngs.push(e),this._redraw(),this},spliceLatLngs:function(e,t){var n=[].splice.apply(this._latlngs,arguments);return this._redraw(),n},closestLayerPoint:function(e){var t=Infinity,n=this._parts,r,i,s=null;for(var o=0,u=n.length;o<u;o++){var a=n[o];for(var f=1,l=a.length;f<l;f++){r=a[f-1],i=a[f];var c=L.LineUtil._sqClosestPointOnSegment(e,r,i);c._sqDist<t&&(t=c._sqDist,s=c)}}return s&&(s.distance=Math.sqrt(t)),s},getBounds:function(){var e=new L.LatLngBounds,t=this.getLatLngs();for(var n=0,r=t.length;n<r;n++)e.extend(t[n]);return e},_getPathPartStr:function(e){var t=L.Path.VML;for(var n=0,r=e.length,i="",s;n<r;n++)s=e[n],t&&s._round(),i+=(n?"L":"M")+s.x+" "+s.y;return i},_clipPoints:function(){var e=this._originalPoints,t=e.length,n,r,i;if(this.options.noClip){this._parts=[e];return}this._parts=[];var s=this._parts,o=this._map._pathViewport,u=L.LineUtil;for(n=0,r=0;n<t-1;n++){i=u.clipSegment(e[n],e[n+1],o,n);if(!i)continue;s[r]=s[r]||[],s[r].push(i[0]);if(i[1]!==e[n+1]||n===t-2)s[r].push(i[1]),r++}},_simplifyPoints:function(){var e=this._parts,t=L.LineUtil;for(var n=0,r=e.length;n<r;n++)e[n]=t.simplify(e[n],this.options.smoothFactor)},_updatePath:function(){this._clipPoints(),this._simplifyPoints(),L.Path.prototype._updatePath.call(this)}}),L.PolyUtil={},L.PolyUtil.clipPolygon=function(e,t){var n=t.min,r=t.max,i,s=[1,4,2,8],o,u,a,f,l,c,h,p,d=L.LineUtil;for(o=0,c=e.length;o<c;o++)e[o]._code=d._getBitCode(e[o],t);for(a=0;a<4;a++){h=s[a],i=[];for(o=0,c=e.length,u=c-1;o<c;u=o++)f=e[o],l=e[u],f._code&h?l._code&h||(p=d._getEdgeIntersection(l,f,h,t),p._code=d._getBitCode(p,t),i.push(p)):(l._code&h&&(p=d._getEdgeIntersection(l,f,h,t),p._code=d._getBitCode(p,t),i.push(p)),i.push(f));e=i}return e},L.Polygon=L.Polyline.extend({options:{fill:!0},initialize:function(e,t){L.Polyline.prototype.initialize.call(this,e,t),e&&e[0]instanceof Array&&(this._latlngs=e[0],this._holes=e.slice(1))},projectLatlngs:function(){L.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[];if(!this._holes)return;for(var e=0,t=this._holes.length,n;e<t;e++){this._holePoints[e]=[];for(var r=0,i=this._holes[e].length;r<i;r++)this._holePoints[e][r]=this._map.latLngToLayerPoint(this._holes[e][r])}},_clipPoints:function(){var e=this._originalPoints,t=[];this._parts=[e].concat(this._holePoints);if(this.options.noClip)return;for(var n=0,r=this._parts.length;n<r;n++){var i=L.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);if(!i.length)continue;t.push(i)}this._parts=t},_getPathPartStr:function(e){var t=L.Polyline.prototype._getPathPartStr.call(this,e);return t+(L.Browser.svg?"z":"x")}}),function(){function e(e){return L.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var n=0,r=t.length;this._iterateLayers(function(e){n<r?e.setLatLngs(t[n++]):this.removeLayer(e)},this);while(n<r)this.addLayer(new e(t[n++],this._options))}})}L.MultiPolyline=e(L.Polyline),L.MultiPolygon=e(L.Polygon)}(),L.Circle=L.Path.extend({initialize:function(e,t,n){L.Path.prototype.initialize.call(this,n),this._latlng=e,this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=e,this._redraw(),this},setRadius:function(e){return this._mRadius=e,this._redraw(),this},projectLatlngs:function(){var e=40075017,t=e*Math.cos(L.LatLng.DEG_TO_RAD*this._latlng.lat),n=this._mRadius/t*360,r=new L.LatLng(this._latlng.lat,this._latlng.lng-n,!0),i=this._map.latLngToLayerPoint(r);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.round(this._point.x-i.x)},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":L.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,"+23592600)},_checkIfEmpty:function(){var e=this._map._pathViewport,t=this._radius,n=this._point;return n.x-t>e.max.x||n.y-t>e.max.y||n.x+t<e.min.x||n.y+t<e.min.y}}),L.CircleMarker=L.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){L.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(e){return this._radius=e,this._redraw(),this}}),L.Polyline.include(L.Path.CANVAS?{_containsPoint:function(e,t){var n,r,i,s,o,u,a,f=this.options.weight/2;L.Browser.touch&&(f+=10);for(n=0,s=this._parts.length;n<s;n++){a=this._parts[n];for(r=0,o=a.length,i=o-1;r<o;i=r++){if(!t&&r===0)continue;u=L.LineUtil.pointToSegmentDistance(e,a[i],a[r]);if(u<=f)return!0}}return!1}}:{}),L.Polygon.include(L.Path.CANVAS?{_containsPoint:function(e){var t=!1,n,r,i,s,o,u,a,f;if(L.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(s=0,a=this._parts.length;s<a;s++){n=this._parts[s];for(o=0,f=n.length,u=f-1;o<f;u=o++)r=n[o],i=n[u],r.y>e.y!=i.y>e.y&&e.x<(i.x-r.x)*(e.y-r.y)/(i.y-r.y)+r.x&&(t=!t)}return t}}:{}),L.Circle.include(L.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,Math.PI*2)},_containsPoint:function(e){var t=this._point,n=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+n}}:{}),L.GeoJSON=L.FeatureGroup.extend({initialize:function(e,t){L.Util.setOptions(this,t),this._geojson=e,this._layers={},e&&this.addGeoJSON(e)},addGeoJSON:function(e){if(e.features){for(var t=0,n=e.features.length;t<n;t++)this.addGeoJSON(e.features[t]);return}var r=e.type==="Feature",i=r?e.geometry:e,s=L.GeoJSON.geometryToLayer(i,this.options.pointToLayer);this.fire("featureparse",{layer:s,properties:e.properties,geometryType:i.type,bbox:e.bbox,id:e.id}),this.addLayer(s)}}),L.Util.extend(L.GeoJSON,{geometryToLayer:function(e,t){var n=e.coordinates,r,i,s,o,u,a=[];switch(e.type){case"Point":return r=this.coordsToLatLng(n),t?t(r):new L.Marker(r);case"MultiPoint":for(s=0,o=n.length;s<o;s++)r=this.coordsToLatLng(n[s]),u=t?t(r):new L.Marker(r),a.push(u);return new L.FeatureGroup(a);case"LineString":return i=this.coordsToLatLngs(n),new L.Polyline(i);case"Polygon":return i=this.coordsToLatLngs(n,1),new L.Polygon(i);case"MultiLineString":return i=this.coordsToLatLngs(n,1),new L.MultiPolyline(i);case"MultiPolygon":return i=this.coordsToLatLngs(n,2),new L.MultiPolygon(i);case"GeometryCollection":for(s=0,o=e.geometries.length;s<o;s++)u=this.geometryToLayer(e.geometries[s],t),a.push(u);return new L.FeatureGroup(a);default:throw Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e,t){var n=parseFloat(e[t?0:1]),r=parseFloat(e[t?1:0]);return new L.LatLng(n,r,!0)},coordsToLatLngs:function(e,t,n){var r,i=[],s,o=e.length;for(s=0;s<o;s++)r=t?this.coordsToLatLngs(e[s],t-1,n):this.coordsToLatLng(e[s],n),i.push(r);return i}}),L.DomEvent={addListener:function(e,t,n,r){var i=L.Util.stamp(n),s="_leaflet_"+t+i;if(e[s])return;var o=function(t){return n.call(r||e,t||L.DomEvent._getEvent())};if(L.Browser.touch&&t==="dblclick"&&this.addDoubleTapListener)this.addDoubleTapListener(e,o,i);else if("addEventListener"in e)if(t==="mousewheel")e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1);else if(t==="mouseenter"||t==="mouseleave"){var u=o,a=t==="mouseenter"?"mouseover":"mouseout";o=function(t){if(!L.DomEvent._checkMouse(e,t))return;return u(t)},e.addEventListener(a,o,!1)}else e.addEventListener(t,o,!1);else"attachEvent"in e&&e.attachEvent("on"+t,o);e[s]=o},removeListener:function(e,t,n){var r=L.Util.stamp(n),i="_leaflet_"+t+r,s=e[i];if(!s)return;L.Browser.touch&&t==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,r):"removeEventListener"in e?t==="mousewheel"?(e.removeEventListener("DOMMouseScroll",s,!1),e.removeEventListener(t,s,!1)):t==="mouseenter"||t==="mouseleave"?e.removeEventListener(t==="mouseenter"?"mouseover":"mouseout",s,!1):e.removeEventListener(t,s,!1):"detachEvent"in e&&e.detachEvent("on"+t,s),e[i]=null},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{while(n&&n!==e)n=n.parentNode}catch(r){return!1}return n!==e},_getEvent:function(){var e=window.event;if(!e){var t=arguments.callee.caller;while(t){e=t.arguments[0];if(e&&window.Event===e.constructor)break;t=t.caller}}return e},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},disableClickPropagation:function(e){L.DomEvent.addListener(e,L.Draggable.START,L.DomEvent.stopPropagation),L.DomEvent.addListener(e,"click",L.DomEvent.stopPropagation),L.DomEvent.addListener(e,"dblclick",L.DomEvent.stopPropagation)},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stop:function(e){L.DomEvent.preventDefault(e),L.DomEvent.stopPropagation(e)},getMousePosition:function(e,t){var n=e.pageX?e.pageX:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=e.pageY?e.pageY:e.clientY+document.body.scrollTop+document.documentElement.scrollTop,i=new L.Point(n,r);return t?i.subtract(L.DomUtil.getViewportOffset(t)):i},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t}},L.Draggable=L.Class.extend({includes:L.Mixin.Events,statics:{START:L.Browser.touch?"touchstart":"mousedown",END:L.Browser.touch?"touchend":"mouseup",MOVE:L.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){if(this._enabled)return;L.DomEvent.addListener(this._dragStartTarget,L.Draggable.START,this._onDown,this),this._enabled=!0},disable:function(){if(!this._enabled)return;L.DomEvent.removeListener(this._dragStartTarget,L.Draggable.START,this._onDown),this._enabled=!1},_onDown:function(e){if(!L.Browser.touch&&e.shiftKey||e.which!==1&&e.button!==1&&!e.touches)return;if(e.touches&&e.touches.length>1)return;var t=e.touches&&e.touches.length===1?e.touches[0]:e,n=t.target;L.DomEvent.preventDefault(e),L.Browser.touch&&n.tagName.toLowerCase()==="a"&&(n.className+=" leaflet-active"),this._moved=!1;if(this._moving)return;L.Browser.touch||(L.DomUtil.disableTextSelection(),this._setMovingCursor()),this._startPos=this._newPos=L.DomUtil.getPosition(this._element),this._startPoint=new L.Point(t.clientX,t.clientY),L.DomEvent.addListener(document,L.Draggable.MOVE,this._onMove,this),L.DomEvent.addListener(document,L.Draggable.END,this._onUp,this)},_onMove:function(e){if(e.touches&&e.touches.length>1)return;L.DomEvent.preventDefault(e);var t=e.touches&&e.touches.length===1?e.touches[0]:e;this._moved||(this.fire("dragstart"),this._moved=!0),this._moving=!0;var n=new L.Point(t.clientX,t.clientY);this._newPos=this._startPos.add(n).subtract(this._startPoint),L.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)},_updatePosition:function(){this.fire("predrag"),L.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(e){if(e.changedTouches){var t=e.changedTouches[0],n=t.target,r=this._newPos&&this._newPos.distanceTo(this._startPos)||0;n.tagName.toLowerCase()==="a"&&(n.className=n.className.replace(" leaflet-active","")),r<L.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",t)}L.Browser.touch||(L.DomUtil.enableTextSelection(),this._restoreCursor()),L.DomEvent.removeListener(document,L.Draggable.MOVE,this._onMove),L.DomEvent.removeListener(document,L.Draggable.END,this._onUp),this._moved&&this.fire("dragend"),this._moving=!1},_setMovingCursor:function(){this._bodyCursor=document.body.style.cursor,document.body.style.cursor="move"},_restoreCursor:function(){document.body.style.cursor=this._bodyCursor},_simulateEvent:function(e,t){var n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}),L.Handler=L.Class.extend({initialize:function(e){this._map=e},enable:function(){if(this._enabled)return;this._enabled=!0,this.addHooks()},disable:function(){if(!this._enabled)return;this._enabled=!1,this.removeHooks()},enabled:function(){return!!this._enabled}}),L.Map.Drag=L.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new L.Draggable(this._map._mapPane,this._map._container),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);var e=this._map.options;e.worldCopyJump&&!e.continuousWorld&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._map.fire("movestart").fire("dragstart")},_onDrag:function(){this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint(new L.LatLng(0,0));this._initialWorldOffset=t.subtract(e)},_onPreDrag:function(){var e=this._map,t=e.options.scale(e.getZoom()),n=Math.round(t/2),r=this._initialWorldOffset.x,i=this._draggable._newPos.x,s=(i-n+r)%t+n-r,o=(i+n+r)%t-n-r,u=Math.abs(s+r)<Math.abs(o+r)?s:o;this._draggable._newPos.x=u},_onDragEnd:function(){var e=this._map;e.fire("moveend").fire("dragend"),e.options.maxBounds&&L.Util.requestAnimFrame(this._panInsideMaxBounds,e,!0,e._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),L.Map.DoubleClickZoom=L.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(e){this.setView(e.latlng,this._zoom+1)}}),L.Map.ScrollWheelZoom=L.Handler.extend({addHooks:function(){L.DomEvent.addListener(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){L.DomEvent.removeListener(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(e){var t=L.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),clearTimeout(this._timer),this._timer=setTimeout(L.Util.bind(this._performZoom,this),50),L.DomEvent.preventDefault(e)},_performZoom:function(){var e=this._map,t=Math.round(this._delta),n=e.getZoom();t=Math.max(Math.min(t,4),-4),t=e._limitZoom(n+t)-n,this._delta=0;if(!t)return;var r=this._getCenterForScrollWheelZoom(this._lastMousePos,t),i=n+t;e.setView(r,i)},_getCenterForScrollWheelZoom:function(e,t){var n=this._map,r=n.getPixelBounds().getCenter(),i=n.getSize().divideBy(2),s=e.subtract(i).multiplyBy(1-Math.pow(2,-t)),o=r.add(s);return n.unproject(o,n._zoom,!0)}}),L.Util.extend(L.DomEvent,{addDoubleTapListener:function(e,t,n){function l(e){if(e.touches.length!==1)return;var t=Date.now(),n=t-(r||t);o=e.touches[0],i=n>0&&n<=s,r=t}function c(e){i&&(o.type="dblclick",t(o),r=null)}var r,i=!1,s=250,o,u="_leaflet_",a="touchstart",f="touchend";e[u+a+n]=l,e[u+f+n]=c,e.addEventListener(a,l,!1),e.addEventListener(f,c,!1)},removeDoubleTapListener:function(e,t){var n="_leaflet_";e.removeEventListener(e,e[n+"touchstart"+t],!1),e.removeEventListener(e,e[n+"touchend"+t],!1)}}),L.Map.TouchZoom=L.Handler.extend({addHooks:function(){L.DomEvent.addListener(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){L.DomEvent.removeListener(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){if(!e.touches||e.touches.length!==2||this._map._animatingZoom)return;var t=this._map.mouseEventToLayerPoint(e.touches[0]),n=this._map.mouseEventToLayerPoint(e.touches[1]),r=this._map.containerPointToLayerPoint(this._map.getSize().divideBy(2));this._startCenter=t.add(n).divideBy(2,!0),this._startDist=t.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=r.subtract(this._startCenter),L.DomEvent.addListener(document,"touchmove",this._onTouchMove,this),L.DomEvent.addListener(document,"touchend",this._onTouchEnd,this),L.DomEvent.preventDefault(e)},_onTouchMove:function(e){if(!e.touches||e.touches.length!==2)return;this._moved||(this._map._mapPane.className+=" leaflet-zoom-anim",this._map.fire("zoomstart").fire("movestart")._prepareTileBg(),this._moved=!0);var t=this._map.mouseEventToLayerPoint(e.touches[0]),n=this._map.mouseEventToLayerPoint(e.touches[1]);this._scale=t.distanceTo(n)/this._startDist,this._delta=t.add(n).divideBy(2,!0).subtract(this._startCenter),this._map._tileBg.style.webkitTransform=[L.DomUtil.getTranslateString(this._delta),L.DomUtil.getScaleString(this._scale,this._startCenter)].join(" "),L.DomEvent.preventDefault(e)},_onTouchEnd:function(e){if(!this._moved||!this._zooming)return;this._zooming=!1;var t=this._map.getZoom(),n=Math.log(this._scale)/Math.LN2,r=n>0?Math.ceil(n):Math.floor(n),i=this._map._limitZoom(t+r),s=i-t,o=this._centerOffset.subtract(this._delta).divideBy(this._scale),u=this._map.getPixelOrigin().add(this._startCenter).add(o),a=this._map.unproject(u);L.DomEvent.removeListener(document,"touchmove",this._onTouchMove),L.DomEvent.removeListener(document,"touchend",this._onTouchEnd);var f=Math.pow(2,s);this._map._runAnimation(a,i,f/this._scale,this._startCenter.add(o))}}),L.Map.BoxZoom=L.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){L.DomEvent.addListener(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){L.DomEvent.removeListener(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;L.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),this._box=L.DomUtil.create("div","leaflet-zoom-box",this._pane),L.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",L.DomEvent.addListener(document,"mousemove",this._onMouseMove,this),L.DomEvent.addListener(document,"mouseup",this._onMouseUp,this),L.DomEvent.preventDefault(e)},_onMouseMove:function(e){var t=this._map.mouseEventToLayerPoint(e),n=t.x-this._startLayerPoint.x,r=t.y-this._startLayerPoint.y,i=Math.min(t.x,this._startLayerPoint.x),s=Math.min(t.y,this._startLayerPoint.y),o=new L.Point(i,s);L.DomUtil.setPosition(this._box,o),this._box.style.width=Math.abs(n)-4+"px",this._box.style.height=Math.abs(r)-4+"px"},_onMouseUp:function(e){this._pane.removeChild(this._box),this._container.style.cursor="",L.DomUtil.enableTextSelection(),L.DomEvent.removeListener(document,"mousemove",this._onMouseMove),L.DomEvent.removeListener(document,"mouseup",this._onMouseUp);var t=this._map.mouseEventToLayerPoint(e),n=new L.LatLngBounds(this._map.layerPointToLatLng(this._startLayerPoint),this._map.layerPointToLatLng(t));this._map.fitBounds(n)}}),L.Handler.MarkerDrag=L.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new L.Draggable(e,e),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(e){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(e){var t=L.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&L.DomUtil.setPosition(this._marker._shadow,t),this._marker._latlng=this._marker._map.layerPointToLatLng(t),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),L.Control={},L.Control.Position={TOP_LEFT:"topLeft",TOP_RIGHT:"topRight",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight"},L.Map.include({addControl:function(e){e.onAdd(this);var t=e.getPosition(),n=this._controlCorners[t],r=e.getContainer();return L.DomUtil.addClass(r,"leaflet-control"),t.indexOf("bottom")!==-1?n.insertBefore(r,n.firstChild):n.appendChild(r),this},removeControl:function(e){var t=e.getPosition(),n=this._controlCorners[t],r=e.getContainer();return n.removeChild(r),e.onRemove&&e.onRemove(this),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=t+"top",r=t+"bottom",i=t+"left",s=t+"right",o=L.DomUtil.create("div",t+"control-container",this._container);L.Browser.touch&&(o.className+=" "+t+"big-buttons"),e.topLeft=L.DomUtil.create("div",n+" "+i,o),e.topRight=L.DomUtil.create("div",n+" "+s,o),e.bottomLeft=L.DomUtil.create("div",r+" "+i,o),e.bottomRight=L.DomUtil.create("div",r+" "+s,o)}}),L.Control.Zoom=L.Class.extend({onAdd:function(e){this._map=e,this._container=L.DomUtil.create("div","leaflet-control-zoom"),this._zoomInButton=this._createButton("Zoom in","leaflet-control-zoom-in",this._map.zoomIn,this._map),this._zoomOutButton=this._createButton("Zoom out","leaflet-control-zoom-out",this._map.zoomOut,this._map),this._container.appendChild(this._zoomInButton),this._container.appendChild(this._zoomOutButton)},getContainer:function(){return this._container},getPosition:function(){return L.Control.Position.TOP_LEFT},_createButton:function(e,t,n,r){var i=document.createElement("a");return i.href="#",i.title=e,i.className=t,L.Browser.touch||L.DomEvent.disableClickPropagation(i),L.DomEvent.addListener(i,"click",L.DomEvent.preventDefault),L.DomEvent.addListener(i,"click",n,r),i}}),L.Control.Attribution=L.Class.extend({initialize:function(e){this._prefix=e||'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>',this._attributions={}},onAdd:function(e){this._container=L.DomUtil.create("div","leaflet-control-attribution"),L.DomEvent.disableClickPropagation(this._container),this._map=e,this._update()},getPosition:function(){return L.Control.Position.BOTTOM_RIGHT},getContainer:function(){return this._container},setPrefix:function(e){this._prefix=e,this._update()},addAttribution:function(e){if(!e)return;this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update()},removeAttribution:function(e){if(!e)return;this._attributions[e]--,this._update()},_update:function(){if(!this._map)return;var e=[];for(var t in this._attributions)this._attributions.hasOwnProperty(t)&&e.push(t);var n=[];this._prefix&&n.push(this._prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(" &mdash; ")}}),L.Control.Layers=L.Class.extend({options:{collapsed:!0},initialize:function(e,t,n){L.Util.setOptions(this,n),this._layers={};for(var r in e)e.hasOwnProperty(r)&&this._addLayer(e[r],r);for(r in t)t.hasOwnProperty(r)&&this._addLayer(t[r],r,!0)},onAdd:function(e){this._map=e,this._initLayout(),this._update()},getContainer:function(){return this._container},getPosition:function(){return L.Control.Position.TOP_RIGHT},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=L.Util.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-control-layers"),L.Browser.touch||L.DomEvent.disableClickPropagation(this._container),this._form=L.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){L.DomEvent.addListener(this._container,"mouseover",this._expand,this),L.DomEvent.addListener(this._container,"mouseout",this._collapse,this);var e=this._layersLink=L.DomUtil.create("a","leaflet-control-layers-toggle");e.href="#",e.title="Layers",L.Browser.touch?L.DomEvent.addListener(e,"click",this._expand,this):L.DomEvent.addListener(e,"focus",this._expand,this),this._map.on("movestart",this._collapse,this),this._container.appendChild(e)}else this._expand();this._baseLayersList=L.DomUtil.create("div","leaflet-control-layers-base",this._form),this._separator=L.DomUtil.create("div","leaflet-control-layers-separator",this._form),this._overlaysList=L.DomUtil.create("div","leaflet-control-layers-overlays",this._form),this._container.appendChild(this._form)},_addLayer:function(e,t,n){var r=L.Util.stamp(e);this._layers[r]={layer:e,name:t,overlay:n}},_update:function(){if(!this._container)return;this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e=!1,t=!1;for(var n in this._layers)if(this._layers.hasOwnProperty(n)){var r=this._layers[n];this._addItem(r),t=t||r.overlay,e=e||!r.overlay}this._separator.style.display=t&&e?"":"none"},_addItem:function(e,t){var n=document.createElement("label"),r=document.createElement("input");e.overlay||(r.name="leaflet-base-layers"),r.type=e.overlay?"checkbox":"radio",r.checked=this._map.hasLayer(e.layer),r.layerId=L.Util.stamp(e.layer),L.DomEvent.addListener(r,"click",this._onInputClick,this);var i=document.createTextNode(" "+e.name);n.appendChild(r),n.appendChild(i);var s=e.overlay?this._overlaysList:this._baseLayersList;s.appendChild(n)},_onInputClick:function(){var e,t,n,r=this._form.getElementsByTagName("input"),i=r.length;for(e=0;e<i;e++)t=r[e],n=this._layers[t.layerId],t.checked?this._map.addLayer(n.layer,!n.overlay):this._map.removeLayer(n.layer)},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),L.Transition=L.Class.extend({includes:L.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:L.DomUtil.setPosition},implemented:function(){return L.Transition.NATIVE||L.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(e,t){var n=L.Transition.CUSTOM_PROPS_SETTERS;e in n?n[e](this._el,t):this._el.style[e]=t}}),L.Transition=L.Transition.extend({statics:function(){var e=L.DomUtil.TRANSITION,t=e==="webkitTransition"||e==="OTransition"?e+"End":"transitionend";return{NATIVE:!!e,TRANSITION:e,PROPERTY:e+"Property",DURATION:e+"Duration",EASING:e+"TimingFunction",END:t,CUSTOM_PROPS_PROPERTIES:{position:L.Browser.webkit?L.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(e,t){this._el=e,L.Util.setOptions(this,t),L.DomEvent.addListener(e,L.Transition.END,this._onTransitionEnd,this),this._onFakeStep=L.Util.bind(this._onFakeStep,this)},run:function(e){var t,n=[],r=L.Transition.CUSTOM_PROPS_PROPERTIES;for(t in e)e.hasOwnProperty(t)&&(t=r[t]?r[t]:t,t=this._dasherize(t),n.push(t));this._el.style[L.Transition.DURATION]=this.options.duration+"s",this._el.style[L.Transition.EASING]=this.options.easing,this._el.style[L.Transition.PROPERTY]=n.join(", ");for(t in e)e.hasOwnProperty(t)&&this._setProperty(t,e[t]);this._inProgress=!0,this.fire("start"),L.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function t(e){return"-"+e.toLowerCase()}var e=/([A-Z])/g;return function(n){return n.replace(e,t)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[L.Transition.PROPERTY]="none",this.fire("step"),this.fire("end"))}}),L.Transition=L.Transition.NATIVE?L.Transition:L.Transition.extend({statics:{getTime:Date.now||function(){return+(new Date)},TIMER:!0,EASINGS:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},CUSTOM_PROPS_GETTERS:{position:L.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(e,t){this._el=e,L.Util.extend(this.options,t);var n=L.Transition.EASINGS[this.options.easing]||L.Transition.EASINGS.ease;this._p1=new L.Point(0,0),this._p2=new L.Point(n[0],n[1]),this._p3=new L.Point(n[2],n[3]),this._p4=new L.Point(1,1),this._step=L.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(e){this._props={};var t=L.Transition.CUSTOM_PROPS_GETTERS,n=L.Transition.UNIT_RE;this.fire("start");for(var r in e)if(e.hasOwnProperty(r)){var i={};if(r in t)i.from=t[r](this._el);else{var s=this._el.style[r].match(n);i.from=parseFloat(s[0]),i.unit=s[1]}i.to=e[r],this._props[r]=i}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=L.Transition.getTime()},_step:function(){var e=L.Transition.getTime(),t=e-this._startTime,n=this.options.duration*1e3;t<n?this._runFrame(this._cubicBezier(t/n)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t=L.Transition.CUSTOM_PROPS_SETTERS,n,r,i;for(n in this._props)this._props.hasOwnProperty(n)&&(r=this._props[n],n in t?(i=r.to.subtract(r.from).multiplyBy(e).add(r.from),t[n](this._el,i)):this._el.style[n]=(r.to-r.from)*e+r.from+r.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")},_cubicBezier:function(e){var t=Math.pow(1-e,3),n=3*Math.pow(1-e,2)*e,r=3*(1-e)*Math.pow(e,2),i=Math.pow(e,3),s=this._p1.multiplyBy(t),o=this._p2.multiplyBy(n),u=this._p3.multiplyBy(r),a=this._p4.multiplyBy(i);return s.add(o).add(u).add(a).y}}),L.Map.include(!L.Transition||!L.Transition.implemented()?{}:{setView:function(e,t,n){t=this._limitZoom(t);var r=this._zoom!==t;if(this._loaded&&!n&&this._layers){var i=this._getNewTopLeftPoint(e).subtract(this._getTopLeftPoint());e=new L.LatLng(e.lat,e.lng);var s=r?!!this._zoomToIfCenterInView&&this._zoomToIfCenterInView(e,t,i):this._panByIfClose(i);if(s)return this}return this._resetView(e,t),this},panBy:function(e){return!e.x&&!e.y?this:(this._panTransition||(this._panTransition=new L.Transition(this._mapPane,{duration:.3}),this._panTransition.on("step",this._onPanTransitionStep,this),this._panTransition.on("end",this._onPanTransitionEnd,this)),this.fire("movestart"),this._panTransition.run({position:L.DomUtil.getPosition(this._mapPane).subtract(e)}),this)},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){this.fire("moveend")},_panByIfClose:function(e){return this._offsetIsWithinView(e)?(this.panBy(e),!0):!1},_offsetIsWithinView:function(e,t){var n=t||1,r=this.getSize();return Math.abs(e.x)<=r.x*n&&Math.abs(e.y)<=r.y*n}}),L.Map.include(L.DomUtil.TRANSITION?{_zoomToIfCenterInView:function(e,t,n){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var r=t-this._zoom,i=Math.pow(2,r),s=n.divideBy(1-1/i);if(!this._offsetIsWithinView(s,1))return!1;this._mapPane.className+=" leaflet-zoom-anim",this.fire("movestart").fire("zoomstart");var o=this.containerPointToLayerPoint(this.getSize().divideBy(2)),u=o.add(s);return this._prepareTileBg(),this._runAnimation(e,t,i,u),!0},_runAnimation:function(e,t,n,r){this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t;var i=L.DomUtil.TRANSFORM;clearTimeout(this._clearTileBgTimer);if(L.Browser.gecko||window.opera)this._tileBg.style[i]+=" translate(0,0)";var s;L.Browser.android?(this._tileBg.style[i+"Origin"]=r.x+"px "+r.y+"px",s="scale("+n+")"):s=L.DomUtil.getScaleString(n,r),L.Util.falseFn(this._tileBg.offsetWidth);var o={};o[i]=this._tileBg.style[i]+" "+s,this._tileBg.transition.run(o)},_prepareTileBg:function(){this._tileBg||(this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),this._tileBg.style.zIndex=1);var e=this._tilePane,t=this._tileBg;t.style[L.DomUtil.TRANSFORM]="",t.style.visibility="hidden",t.empty=!0,e.empty=!1,this._tilePane=this._panes.tilePane=t,this._tileBg=e,this._tileBg.transition||(this._tileBg.transition=new L.Transition(this._tileBg,{duration:.3,easing:"cubic-bezier(0.25,0.1,0.25,0.75)"}),this._tileBg.transition.on("end",this._onZoomTransitionEnd,this)),this._stopLoadingBgTiles()},_stopLoadingBgTiles:function(){var e=[].slice.call(this._tileBg.getElementsByTagName("img"));for(var t=0,n=e.length;t<n;t++)e[t].complete||(e[t].onload=L.Util.falseFn,e[t].onerror=L.Util.falseFn,e[t].src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",e[t].parentNode.removeChild(e[t]),e[t]=null)},_onZoomTransitionEnd:function(){this._restoreTileFront(),L.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),this._mapPane.className=this._mapPane.className.replace(" leaflet-zoom-anim",""),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){!this._animatingZoom&&!this.touchZoom._zooming&&(this._tileBg.innerHTML="")}}:{}),L.Map.include({locate:function(e){this._locationOptions=e=L.Util.extend({watch:!1,setView:!1,maxZoom:Infinity,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},e);if(!navigator.geolocation)return this.fire("locationerror",{code:0,message:"Geolocation not supported."});var t=L.Util.bind(this._handleGeolocationResponse,this),n=L.Util.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,n,e):navigator.geolocation.getCurrentPosition(t,n,e),this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId)},locateAndSetView:function(e,t){return t=L.Util.extend({maxZoom:e||Infinity,setView:!0},t),this.locate(t)},_handleGeolocationError:function(e){var t=e.code,n=t===1?"permission denied":t===2?"position unavailable":"timeout";this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(e){var t=180*e.coords.accuracy/4e7,n=t*2,r=e.coords.latitude,i=e.coords.longitude,s=new L.LatLng(r,i),o=new L.LatLng(r-t,i-n),u=new L.LatLng(r+t,i+n),a=new L.LatLngBounds(o,u);if(this._locationOptions.setView){var f=Math.min(this.getBoundsZoom(a),this._locationOptions.maxZoom);this.setView(s,f)}this.fire("locationfound",{latlng:s,bounds:a,accuracy:e.coords.accuracy})}});
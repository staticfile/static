!function(adhoc,document,window,undefined){"use strict";var protocol="https:"===window.location.protocol?"https:":"http:",ADHOC_GETFLAGS_URL=protocol+"//experiment.appadhoc.com/get_flags",ADHOC_FORCEEXP_URL=protocol+"//api.appadhoc.com/optimizer/api/forceexp.php",ADHOC_TRACKING_URL=protocol+"//tracking.appadhoc.com:23462";Date.now=Date.now||function(){return(new Date).getTime()},JSON.stringify=JSON.stringify||function(a){var b=typeof a;if("object"!=b||null===a)return"string"==b&&(a='"'+a+'"'),String(a);var c,d,e=[],f=a&&a.constructor==Array;for(c in a)d=a[c],b=typeof d,"string"==b?d='"'+d+'"':"object"==b&&null!==d&&(d=JSON.stringify(d)),e.push((f?"":'"'+c+'":')+String(d));return(f?"[":"{")+String(e)+(f?"]":"}")},JSON.parse=JSON.parse||function(str){return eval("("+str+")")};var getCookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(e.startsWith(a))return e.substring(b.length,e.length)}return null},setCookie=function(a,b,c){var d="";if(c)var e=new Date(Date.now()+24*c*60*60*1e3),d="; expires="+e.toUTCString();var f=a+"="+b+d+"; path=/";document.cookie=f},getCachedFlags=function(){for(var a={},b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1);if(0==d.indexOf("ADHOC_FLAG_")){var e=d.substring(11,d.indexOf("=")),f=d.substring(d.indexOf("=")+1,d.length);"false"===f?f=!1:"true"===f?f=!0:"NaN"!=Number(f)&&(f=Number(f)),a[e]=f}}return a},AJAX=function(a,b,c){a=a||"",b=b||{};var d=new XMLHttpRequest;null!=c&&(d.onload=function(){var a=JSON.parse(this.responseText);for(var b in a)setCookie("ADHOC_FLAG_"+b,a[b],365);c(a)}),d.open("POST",a),d.setRequestHeader("Content-Type","application/json;charset=UTF-8"),d.send(JSON.stringify(b))},getBrowserInfo=function(){var a,b=navigator.userAgent,c=b.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(b)||[],{n:"IE",v:a[1]||""}):"Chrome"===c[1]&&(a=b.match(/\bOPR\/(\d+)/),null!=a)?{n:"Opera",v:a[1]}:(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(a=b.match(/version\/(\d+)/i))&&c.splice(1,1,a[1]),{n:c[0],v:c[1]})},thisAdhoc=adhoc;thisAdhoc.generateClientId=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},thisAdhoc.init=function(a,b){thisAdhoc.ak=a;var c=String(getCookie("ADHOC_MEMBERSHIP_CLIENT_ID"));null==c&&(c=thisAdhoc.generateClientId(),setCookie("ADHOC_MEMBERSHIP_CLIENT_ID",c,365)),thisAdhoc.c=b||c,thisAdhoc.c=String(thisAdhoc.c)},thisAdhoc.getCachedExperimentFlags=function(){return getCachedFlags()},thisAdhoc.getExperimentFlags=function(a,b){a=a||function(){},b&&"function"==typeof b&&b(getCachedFlags());var c=getBrowserInfo(),d={app_key:thisAdhoc.ak,summary:{OS:c.n,OS_version:c.v},custom:{}};null!=thisAdhoc.c&&(d.client_id=thisAdhoc.c),AJAX(ADHOC_GETFLAGS_URL,d,a)},thisAdhoc.incrementStat=function(a,b){var c=getBrowserInfo(),d={adhoc_app_track_id:thisAdhoc.ak,client_id:thisAdhoc.c,event_type:"REPORT_STAT",timestamp:Date.now()/1e3,summary:{OS:c.n,OS_version:c.v},stat_key:a,stat_value:b};AJAX(ADHOC_TRACKING_URL,d,null)},thisAdhoc.forceExperiment=function(a){var b={client_id:thisAdhoc.c,qr_code:a};AJAX(ADHOC_FORCEEXP_URL,b,null)}}(window.adhoc="undefined"!=typeof Object.create?Object.create(null):{},document,window);
